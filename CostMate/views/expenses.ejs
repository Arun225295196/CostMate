<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<<<<<<< HEAD
    <title>Expenses - CostMate</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        
        * { box-sizing: border-box; }
        body {
            background: #0f0f23;
            background-image: radial-gradient(at 25% 25%, rgba(99,102,241,0.1) 0%, transparent 50%),
                              radial-gradient(at 75% 75%, rgba(139,92,246,0.1) 0%, transparent 50%);
            font-family: 'Inter', sans-serif;
            margin: 0;
            min-height: 100vh;
            color: #e2e8f0;
        }

        
        .navbar-fixed nav {
            background: rgba(15, 23, 42, 0.8) !important;
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(51, 65, 85, 0.3);
            box-shadow: none;
            height: 70px;
            line-height: 70px;
        }
        .nav-wrapper { padding: 0 2rem; }
        .brand-logo {
            font-size: 1.8rem !important;
            font-weight: 700 !important;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        nav ul li a { font-weight: 500; padding: 0 20px !important; border-radius: 8px; margin: 0 4px; }
        nav ul li a:hover { background: rgba(99,102,241,0.1); }
        nav ul li.active a { background: rgba(99,102,241,0.2); }

        
        .main-container { margin-top: 90px; padding: 2rem; max-width: 1200px; margin-left:auto; margin-right:auto; }

        
        .page-header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; margin-bottom: 2rem; }
        .page-title {
            font-size: 2.5rem; font-weight: 700; margin: 0;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-actions a {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 12px;
            padding: 0.75rem 1.5rem;
            color: white;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }
        .header-actions a:hover { transform: translateY(-2px); }

        
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); gap:1.5rem; margin-bottom:2rem; }
        .summary-card {
            background: rgba(15,23,42,0.6);
            border: 1px solid rgba(51,65,85,0.3);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(20px);
        }
        .summary-value { font-size: 2rem; font-weight: 700; color: #f8fafc; margin-bottom:0.5rem; }
        .summary-label { font-size: 0.9rem; color: #94a3b8; text-transform: uppercase; letter-spacing:0.05em; }

        
        .expenses-card { background: rgba(15,23,42,0.6); border-radius: 20px; backdrop-filter: blur(20px); overflow:hidden; }
        .card-header { padding: 2rem; border-bottom: 1px solid rgba(51,65,85,0.3); background: linear-gradient(135deg, rgba(99,102,241,0.05), rgba(139,92,246,0.05)); }
        .card-title { font-size: 1.5rem; font-weight: 600; display:flex; align-items:center; gap:0.75rem; color:#f8fafc; margin:0; }

        
        .expense-item { display:flex; justify-content:space-between; align-items:center; padding:1.5rem 2rem; border-bottom:1px solid rgba(51,65,85,0.2); transition: all 0.3s ease; }
        .expense-item:hover { background: rgba(99,102,241,0.05); }
        .expense-left { display:flex; align-items:center; gap:1.25rem; flex:1; min-width:0; }
        .category-icon { width:50px; height:50px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:1.5rem; flex-shrink:0; }
        .food { background: linear-gradient(135deg, #f59e0b, #f97316); }
        .transport { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .entertainment { background: linear-gradient(135deg, #ec4899, #be185d); }
        .bills { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .shopping { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .health { background: linear-gradient(135deg, #10b981, #059669); }
        .other { background: linear-gradient(135deg, #6b7280, #4b5563); }

        .expense-details { flex:1; min-width:0; }
        .expense-description { font-weight:600; font-size:1.1rem; color:#f8fafc; margin-bottom:0.25rem; white-space: nowrap; overflow:hidden; text-overflow: ellipsis; }
        .expense-meta { display:flex; align-items:center; gap:1rem; font-size:0.85rem; color:#94a3b8; }
        .expense-right { display:flex; align-items:center; gap:1.5rem; flex-shrink:0; }
        .expense-amount { font-size:1.3rem; font-weight:700; color:#ef4444; text-align:right; }
        .expense-actions button { width:36px; height:36px; border-radius:8px; border:none; display:flex; align-items:center; justify-content:center; cursor:pointer; transition: all 0.3s ease; }
        .delete-btn { background: rgba(239,68,68,0.1); color:#ef4444; }
        .delete-btn:hover { background: rgba(239,68,68,0.2); transform: scale(1.1); }

        /* Empty State */
        .empty-state { text-align:center; padding:4rem 2rem; color:#64748b; }
        .empty-state i { font-size:5rem; margin-bottom:1.5rem; opacity:0.3; }
        .empty-state h3 { font-weight:600; margin-bottom:1rem; color:#94a3b8; }
        .empty-state p { margin-bottom:2rem; font-size:1rem; line-height:1.5; }

        /* Floating Action Button */
        .fab { position: fixed; bottom: 2rem; right:2rem; width:60px; height:60px; border-radius:50%; background: linear-gradient(135deg, #6366f1, #8b5cf6); display:flex; align-items:center; justify-content:center; box-shadow:0 8px 25px rgba(99,102,241,0.4); transition: all 0.3s ease; color:white; text-decoration:none; z-index:1000; }
        .fab:hover { transform:scale(1.1); box-shadow:0 12px 35px rgba(99,102,241,0.5); }

    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="navbar-fixed">
        <nav>
            <div class="nav-wrapper">
                <a href="/dashboard" class="brand-logo">
                    <i class="material-icons left">account_balance_wallet</i>CostMate
                </a>
                <ul id="nav-mobile" class="right hide-on-med-and-down">
                    <li><a href="/dashboard"><i class="material-icons left">dashboard</i>Dashboard</a></li>
                    <li class="active"><a href="/expenses"><i class="material-icons left">receipt</i>Expenses</a></li>
                    <li><a href="/expenses/add"><i class="material-icons left">add</i>Add Expense</a></li>
                    <li><a href="/logout"><i class="material-icons left">exit_to_app</i>Logout</a></li>
                </ul>
            </div>
        </nav>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">Your Expenses</h1>
            <div class="header-actions">
                <a href="/expenses/add">
                    <i class="material-icons">add</i>Add Expense
                </a>
            </div>
        </div>

        <!-- Success Message -->
        <% if (typeof success_msg !== 'undefined' && success_msg.length > 0) { %>
            <div class="alert-success">
                <i class="material-icons">check_circle</i>
                <span><%= success_msg %></span>
            </div>
        <% } %>

        <% if (expenses && expenses.length > 0) { %>
            <!-- Summary Cards -->
            <div class="summary-grid">
                <div class="summary-card">
                    <div class="summary-value"><%= expenses.length %></div>
                    <div class="summary-label">Total Expenses</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value">$<%= expenses.reduce((sum, exp) => sum + exp.amount, 0).toFixed(2) %></div>
                    <div class="summary-label">Total Amount</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value">$<%= (expenses.reduce((sum, exp) => sum + exp.amount, 0)/expenses.length).toFixed(2) %></div>
                    <div class="summary-label">Average Expense</div>
                </div>
            </div>

            <!-- Expenses List -->
            <div class="expenses-card">
                <div class="card-header">
                    <h2 class="card-title">
                        <i class="material-icons">receipt_long</i>
                        Recent Transactions
                    </h2>
                </div>
                <div class="expenses-list">
                    <% expenses.forEach(function(expense) { %>
                        <div class="expense-item">
                            <div class="expense-left">
                                <div class="category-icon <%= expense.category.toLowerCase() %>">
                                    <% if (expense.category === 'Food') { %>üçΩÔ∏è
                                    <% } else if (expense.category === 'Transport') { %>üöó
                                    <% } else if (expense.category === 'Entertainment') { %>üé¨
                                    <% } else if (expense.category === 'Bills') { %>üí°
                                    <% } else if (expense.category === 'Shopping') { %>üõçÔ∏è
                                    <% } else if (expense.category === 'Health') { %>üè•
                                    <% } else { %>üì¶<% } %>
                                </div>
                                <div class="expense-details">
                                    <div class="expense-description"><%= expense.description %></div>
                                    <div class="expense-meta">
                                        <span><i class="material-icons tiny">category</i> <%= expense.category %></span>
                                        <span><i class="material-icons tiny">payment</i> <%= expense.paymentMethod %></span>
                                        <span><i class="material-icons tiny">date_range</i> <%= new Date(expense.date).toLocaleDateString() %></span>
                                    </div>
                                </div>
                            </div>
                            <div class="expense-right">
                                <div class="expense-amount">-$<%= expense.amount.toFixed(2) %></div>
                                <div class="expense-actions">
                                    <form method="POST" action="/expenses/<%= expense._id %>?_method=DELETE">
                                        <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this expense?')">
                                            <i class="material-icons">delete</i>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                </div>
            </div>
        <% } else { %>
            <div class="expenses-card">
                <div class="empty-state">
                    <i class="material-icons">receipt</i>
                    <h3>No expenses recorded yet</h3>
                    <p>Start tracking your expenses to get better insights into your spending habits.</p>
                    <a href="/expenses/add" class="header-actions">
                        <i class="material-icons">add</i> Add Your First Expense
                    </a>
                </div>
            </div>
        <% } %>
    </div>

    <!-- Floating Action Button -->
    <a href="/expenses/add" class="fab">
        <i class="material-icons">add</i>
    </a>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
=======
    <title><%= title %></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <%- include('partials/navbar') %>
    
    <main class="container">
        <h4>My Expenses</h4>
        
        <%- include('partials/messages') %>
        
        <div class="row">
            <div class="col s12">
                <a href="/expenses/add" class="btn blue waves-effect waves-light">
                    <i class="material-icons left">add</i>Add Expense
                </a>
            </div>
        </div>
        
        <div class="row">
            <div class="col s12">
                <% if (typeof expenses !== 'undefined' && expenses.length > 0) { %>
                    <table class="striped responsive-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Category</th>
                                <th>Description</th>
                                <th>Amount</th>
                                <th>Payment</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% expenses.forEach(expense => { %>
                                <tr>
                                    <td><%= new Date(expense.date).toLocaleDateString() %></td>
                                    <td>
                                        <span class="expense-category category-<%= expense.category %>">
                                            <%= expense.category %>
                                        </span>
                                    </td>
                                    <td><%= expense.description %></td>
                                    <td><strong>$<%= expense.amount.toFixed(2) %></strong></td>
                                    <td><%= expense.paymentMethod %></td>
                                    <td>
                                        <a href="/expenses/edit/<%= expense._id %>" class="btn-small blue">
                                            <i class="material-icons">edit</i>
                                        </a>
                                        <form action="/expenses/<%= expense._id %>?_method=DELETE" method="POST" style="display: inline;">
                                            <button type="submit" class="btn-small red" onclick="return confirm('Delete this expense?')">
                                                <i class="material-icons">delete</i>
                                            </button>
                                        </form>
                                    </td>
                                </tr>
                            <% }) %>
                        </tbody>
                    </table>
                    
                    <% if (typeof currentPage !== 'undefined' && typeof totalPages !== 'undefined' && totalPages > 1) { %>
                        <ul class="pagination center-align" style="margin-top: 30px;">
                            <% for(let i = 1; i <= totalPages; i++) { %>
                                <li class="<%= currentPage === i ? 'active blue' : 'waves-effect' %>">
                                    <a href="/expenses?page=<%= i %>"><%= i %></a>
                                </li>
                            <% } %>
                        </ul>
                    <% } %>
                <% } else { %>
                    <div class="card-panel">
                        <p class="center-align">No expenses found. Start by adding your first expense!</p>
                    </div>
                <% } %>
            </div>
        </div>
    </main>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="/js/main.js"></script>
>>>>>>> e1b026d2f834834f296bc9178de6330ffc3dae8d
</body>
</html>
